<div class='scroll post-view-section'>

	<!-- back button -->
	<a onclick='history.back()' style='display: block;'><u>Back</u></a>

<!-- 	<div class='linked-post-container ancestor' ng-repeat='ancestor in ancestors | orderBy: "+":reverse ' layout='row' layout-wrap>
		<md-card class='post-details' layout='column' flex ng-click='expand(ancestor.id)'>
			<div class='post-title linked'>{{ancestor.title}} <i style='font-size: 10px'>By {{users[ancestor.createdBy].name}}</i></div>
		</md-card>
	</div> -->

	<!-- parent -->
	<div class='linked-post-container' layout='row' layout-wrap dnd-list dnd-drop='linkNewParent(item, post_details.id)'>
		
		<md-button class="md-mini" aria-label="switch-parent" md-no-ink="false" md-ripple-size="auto" ng-click='parent - 1 >= 0 ? parent=parent-1 :  null'>
			<ng-md-icon icon="keyboard_arrow_left" size='24' style="fill: #222" ng-if='post_details.parents[parent].id!=null && parent > 0 '></ng-md-icon>
		</md-button>
		
		<md-card class='post-details pointer' layout='column' flex ng-click='goToNode(post_details.parents[parent].id)' ng-if='post_details.parents[parent].id!=null'>
			<div class='post-title linked'>{{parent+1}} | {{post_details.parents.length }} {{post_details.parents[parent].title}} </div>
			<div layout="row">
				<img class='author-profile-picture linked' src='users[post_details.parents[parent].createdBy].avatar'>
				<div class='author-name linked'>{{users[post_details.parents[parent].createdBy].name}}</div>
			</div>
		</md-card>


		<md-card class='post-details pointer' layout='column' flex ng-if='post_details.parents[parent].id==null'>
			<div class='post-title linked'>This post has no preceeding posts.</div>
		</md-card>

		
		<md-button class="md-mini" aria-label="switch-parent" md-no-ink="false" md-ripple-size="auto" ng-click='parent + 1 < post_details.parents.length ? parent=parent+1: null'>
			<ng-md-icon icon="keyboard_arrow_right" size='24' style="fill: #222" ng-if='post_details.parents[parent].id!=null && parent<post_details.parents.length-1'></ng-md-icon>
		</md-button>

	</div>

	<!-- main -->
	<div class='post-container' layout='column' dnd-draggable='post_details'>

		<md-card class='post-details' layout='column' flex>

			<div class='post-actions'>

				<div class='action' ng-click='reply(post_details)'>
					<ng-md-icon icon="reply" size='20' style="fill: #AFAFAF"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Reply</md-tooltip>
				</div>

				<div class='action' ng-click='comment(post_details.id)'>
					<ng-md-icon icon="chat_bubble" size='20' style="fill: #AFAFAF"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Comment</md-tooltip>
				</div>

				<div class='action' ng-if='post_details.createdBy != user.id;' ng-click='like(post_details.id)'>
					<ng-md-icon icon="thumb_up" size='20' style="fill: #AFAFAF"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Like this post!</md-tooltip>
				</div>

				<div class='action' ng-if='post_details.createdBy == user.id && post_details.children[0].id == null && post_details.comments[0].id == null;' ng-click='delete(post_details.id)'>
					<ng-md-icon icon="delete" size='20' style="fill: #AFAFAF"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Delete</md-tooltip>
				</div>

				<!-- <div class='action' ng-if='post_details.createdBy == user.id;' ng-click='edit(post_details.id)'>
					<ng-md-icon icon="mode_edit" size='20' style="fill: #AFAFAF"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Edit</md-tooltip>
				</div> -->


				<!-- <div flex='20' style='height: 80px; border: 1px dashed gray; text-align: center; line-height: 80px;'>
					<md-button class="md-mini" ng-disabled="false" aria-label="add a link" md-no-ink="false" md-ripple-size="full">
						Add a link
					</md-button>
				</div> -->
			</div>


			<div class='post-title main'> 
					<ng-md-icon icon="{{ post_details.type | post_icon }}" size='28' style="fill: #AFAFAF;">
						<md-tooltip md-direction="bottom">{{ post_details.type }}</md-tooltip>
					</ng-md-icon> 
					{{ post_details.title }}
			</div>
			<div layout="row">
				<img class='author-profile-picture main' src='users[post_details.createdBy].avatar'>
				<div class='author-name main'> {{ users[post_details.createdBy].name }}</div>
			</div>
			<div class='tags'>
				<span ng-repeat='tag in post_details.tags'>#{{tags[tag.tag_id].name}}</span>
			</div>

			<md-divider></md-divider>

			<div class='post-body'>	

				<!-- content -->
				<div ng-bind-html='post_details.body'></div>

				<!-- Attachments - if present -->
	            <div ng-if='post_details.attachments[0].id!=null'>
	                <b>Attachments ({{post_details.attachments.length}} files)</b>
	                <div ng-repeat="attachment in post_details.attachments">
	                  <a href="/api/post_details/{{post_details.id}}/attachments/{{attachment.id}}" target=_blank>
	                    <div layout='row'>
	                      <div class='flex-20 attachment-thumb' style='background-image: url({{getThumb(post_details.id, attachment.attachment)}});'></div>
	                      <div class='flex-80'>
	                          <div class='attachment-details'>
	                            <h4>{{attachment.attachment.name}}</h4>
	                            <div> Size: {{ (attachment.attachment.size/1000000).toFixed(2) }} MB </div>
	                          </div>
	                      </div>
	                    </div>
	                  </a>
	                </div>
	            </div>

	            <!-- post-functions -->
				<div class='comment' layout='column' ng-if='post_details.comments[0].id != null'>

					<md-divider></md-divider>
	                
	                <h3 style='line-height: 24px;'>
	                	Comments 
	                </h3>

	                <!-- commenting area -->
	                <textarea ng-show='showComment'>
	                	
	                </textarea>

					<md-divider></md-divider>

	                <div class='comment' ng-repeat='comment in post_details.comments | orderBy: dateCreated'>
	                    
	                    <b>{{users[comment.createdBy].nickname ? users[comment.createdBy].nickname : users[comment.createdBy].name}}</b> says:

	                    <div ng-bind-html="comment.body"></div>
	                    
	                    <div class='pointer' style='font-size: 10px; color: blue;' ng-if='comment.createdBy == user.id' ng-click='delete(comment.id, true)'>[ Delete ]</div>

	                </div>

				</div>
			</div>




		</md-card>

	</div>

	<!-- children -->
	<div class='linked-post-container' layout='row' layout-wrap dnd-list dnd-drop='linkNewChild(item, post_details.id)'>
		
		<md-button class="md-mini" aria-label="switch-child" md-no-ink="false" md-ripple-size="auto" ng-click='child - 1 >= 0 ? child=child-1 :  null'>
			<ng-md-icon icon="keyboard_arrow_left" size='24' style="fill: #222" ng-if='post_details.children[child].id!=null && child>0'></ng-md-icon>
		</md-button>
		
		<md-card class='post-details pointer' layout='column' flex ng-click='goToNode(post_details.children[child].id)' ng-if='post_details.children[child].id!=null'>
			<div class='post-title linked'>{{child+1}} | {{post_details.children.length }} {{post_details.children[child].title}} </div>
			<div layout="row">
				<img class='author-profile-picture linked' src='users[post_details.children[child].createdBy].avatar'>
				<div class='author-name linked'>{{users[post_details.children[child].createdBy].name}}</div>
			</div>
		</md-card>


		<md-card class='post-details pointer' layout='column' flex ng-if='post_details.children[child].id==null'>
			<div class='post-title linked'>This post has no replies.</div>
		</md-card>

		<md-button class="md-mini" aria-label="switch-child" md-no-ink="false" md-ripple-size="auto" ng-click='child + 1 < post_details.children.length ? child=child+1: null'>
			<ng-md-icon icon="keyboard_arrow_right" size='24' style="fill: #222" ng-if='post_details.children[child].id!=null && child<post_details.children.length-1'></ng-md-icon>
		</md-button>

	</div>

	<!-- <div class='linked-post-container ancestor' ng-repeat='descendant in descendants' layout='row' layout-wrap>
		<md-card class='post-details' layout='column' flex ng-click='expand(ancestor.id)'>
			<div class='post-title linked'>{{post_details.children[child].title}} <span ng-if='post_details.children[child].id==null'>This node has no parents</span></div>
		</md-card>
	</div> -->


</div>