<!-- Profile Modal -->
<div id="profileModal" class="modal fade" role="dialog" ng-controller='ProfileController as profilectrl
'>
  
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">

        <div class="modal-body">

                <h5>{{ user.name }}</h5>

                <hr/><br>

                <!-- Profile Details -->
                <div class='row profile-header'>
                  
                  <div class='col-xs-4 profile-details-container no-margin-padding'>
                        <!-- <h5 class='username no-margin-padding'>{{ user.name }}</h4> -->
                        <h6 class='username no-margin-padding'>Known as: <br>{{ user.nickname ? user.nickname : "--"}}</h6>
                  </div>

                  <div class='col-xs-3'>
                        <h6 class='stat-name no-margin-padding'>Total Views:  <b>{{views}}</b> </h6>
                        <h6 class='stat-name no-margin-padding'>Average Rating:  <b>{{ rating == "NaN" ? "No Rating" : rating }}</b> </h6>
                        <h6 class='stat-name no-margin-padding' ng-if='level'>Level:  <b>{{ level }}</b> </h6>
                  </div>

                  <div class='col-xs-3 profile-img-container' style='background: url({{user.avatar}})'></div>

                </div>

                <!-- Lists -->
                <div uib-accordion class="accordion"> 

                    <div uib-accordion-group class='profile-item-container'>
                      <uib-accordion-heading> 
                          <h5>Bookmarks</h5>
                      </uib-accordion-heading>

                      <div class='col-sm-12 text-center' ng-if='user.bookmarks.length == 1 && user.bookmarks[0].title == null'><br><h6>No Nodes Bookmarked</h6><br></div>
                      
                      <div class='col-sm-12' ng-if='user.bookmarks.length > 0 && user.bookmarks[0].title != null' ng-repeat="bookmark in user.bookmarks | orderBy : '-createdOn' ">
                          <div class='profile-item'>
                            <div class='row pointer' ng-click='goToNode(bookmark.id)' data-dismiss='modal'>
                              <div class='col-sm-12'>
                                <h6>Bookmarked <u>{{ bookmark.title }}</u> on {{ bookmark.createdOn | date : 'mediumDate' }}</h6>
                              </div>
                            </div>
                          </div>
                      </div>
                    </div>
                   
                    <div uib-accordion-group class='profile-item-container'>
                      <uib-accordion-heading> 
                          <h5>Nodes</h5>
                      </uib-accordion-heading>

                      <div class='col-sm-12 text-center' ng-if='user.contributions.length == 0'><br><h6>No Nodes Created</h6><br></div>
                      
                      <div class='col-sm-12' ng-repeat="contribution in user.contributions | orderBy : '-createdOn' track by $index">
                          <div class='profile-item'>
                            <div class='row pointer' ng-click='goToNode(contribution.id)' data-dismiss='modal'>
                              <div class='col-sm-6'>
                                <h6>{{ contribution.title }}</h6>
                              </div>
                              <div class='col-sm-2'>
                                <h6>{{ contribution.views }} views</h6>
                              </div>
                              <div class='col-sm-4'>
                                <h6>{{ contribution.rating.toFixed(1) }} from {{ contribution.rateCount }} ratings</h6>
                              </div>
                            </div>
                          </div>
                      </div>
                    </div>        

                    <div uib-accordion-group class='profile-item-container'>
                        <uib-accordion-heading> 
                          <h5>Tags</h5>
                        </uib-accordion-heading>
                        
                        <div class='col-sm-12 text-center' ng-if='(tags | filter:{createdBy:user.id}:true).length == 0'><br><h6>No Tags Created</h6><br></div>

                        <div class='col-sm-12' ng-repeat="tag in tags | filter:{createdBy:user.id}:true">
                            <div class='profile-item'>
                              <div class='row'>
                                <div class='col-sm-6'>
                                  <h6>{{tag.name }}</h6>
                                </div>
                                <div class='col-sm-6'>
                                  <h6>{{ tag.contributionCount }} nodes with this tag</h6>
                                </div>
                              </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Buttons -->
                <div class='row text-right modal-section'>
                  
                  <span ng-if='own'>
                    <button type="button" class="btn btn-default modal-button" ng-disabled="true" uib-tooltip='User Groups - Coming Soon!' uib-position='top'><i class='fa fa-users'></i></button>
                    <button type="button" class="btn btn-default modal-button" ng-click='profilectrl.profileEdit=true' ng-hide="profilectrl.profileEdit" uib-tooltip='Edit Profile' uib-position='top'><i class='fa fa-pencil'></i></button>
                    <button type="button" class="btn btn-default modal-button" uib-tooltip='Logout' uib-position='top'><a href='/logout'><i class='fa fa-power-off'></i></a></button>
                  </span>
                  
                  <button type="button" class="btn btn-default modal-button" data-dismiss='modal' ng-click='own ? close() : hideAuthorModal();' uib-tooltip='Close' uib-position='top'><i class='fa fa-close'></i></button>
                
                </div>

        </div> 

    </div>

    <ng-include src="'components/profile/editProfile.html'" ng-if='own'></ng-include>

  </div>

</div>


